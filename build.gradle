/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

apply plugin: 'java'
apply plugin: 'application'

mainClassName = 'net.nahknarmi.arch.adapter.StructurizrQuickstart'
sourceCompatibility = 1.8
targetCompatibility = 1.8
version = '1.0'

compileJava.options.encoding = 'UTF-8'
compileTestJava.options.encoding = 'UTF-8'

sourceSets.main.java.srcDirs = ['build/generated/src/main/java','src/main/java']

repositories {
    mavenCentral()
}

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        // or, via Gradle Plugin Portal:
        // url "https://plugins.gradle.org/m2/"
    }
    dependencies {
        classpath "org.openapitools:openapi-generator-gradle-plugin:4.2.2"
    }
}

apply plugin: 'org.openapi.generator'

dependencies {
    //Google doc api
    compile 'com.google.api-client:google-api-client:1.30.1'
    compile 'com.google.oauth-client:google-oauth-client-jetty:1.30.1'
    compile 'com.google.apis:google-api-services-docs:v1-rev20190827-1.30.1'

    //Structurizr
    compile 'com.structurizr:structurizr-client:1.3.1'
    compile 'com.google.code.gson:gson:2.8.6'

    //Swagger
    compile group: 'io.swagger', name: 'swagger-core', version: '1.5.0'


    //Testing
    testCompile 'junit:junit:4.12'
}

openApiGenerate {
    generatorName = "java"
    inputSpec = "$rootDir/specs/structurizr-api.yaml".toString()
    outputDir = "$buildDir/generated".toString()
//    apiPackage = "org.openapi.example.api"
//    invokerPackage = "org.openapi.example.invoker"
    modelPackage = "org.openapi.example.model"
//    modelFilesConstrainedTo = [
//            "Error"
//    ]
    configOptions = [
            dateLibrary: "java8"
    ]
}

compileJava.dependsOn tasks.openApiGenerate
